{
    "name": "base-modules",
    "modules": [
        "shared-modules/gtk2/gtk2.json",
        "shared-modules/python2.7/python-2.7.15.json",
        {
            "name": "webkitgtk",
            "config-opts": [ "--with-gtk=2.0", "--disable-webkit2", "--disable-geolocation", "--disable-video",
                             "--disable-spellcheck", "--disable-credential-storage", "--disable-web-audio" ],
            "build-options" : {
                "env": {
                    "PYTHON": "/usr/bin/python3"
                },
                "cflags": "-O2 -g -pipe -Wno-expansion-to-defined -Wno-class-memaccess -fno-delete-null-pointer-checks -fpermissive",
                "cflags-override": true,
                "cxxflags": "-O2 -g -pipe -Wno-expansion-to-defined -Wno-class-memaccess -fno-delete-null-pointer-checks -fpermissive",
                "cxxflags-override": true,
                "arch" : {
                    "aarch64" : {
                        "cflags": "-O2 -g -pipe -DENABLE_YARR_JIT=0 -Wno-expansion-to-defined -Wno-class-memaccess -fno-delete-null-pointer-checks -fpermissive",
                        "cflags-override": true,
                        "cxxflags": "-O2 -g -pipe -DENABLE_YARR_JIT=0 -Wno-expansion-to-defined -Wno-class-memaccess -fno-delete-null-pointer-checks -fpermissive",
                        "cxxflags-override": true,
                        "config-opts" : [
                            "--disable-jit"
                        ]
                    }
                }
            },

            "cleanup": [ "/share/doc", "/bin" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.webkitgtk.org/releases/webkitgtk-2.4.11.tar.xz",
                    "sha256": "588aea051bfbacced27fdfe0335a957dca839ebe36aa548df39c7bbafdb65bf7"
                },
                {
                    "type": "patch",
                    "path": "patches/webkitgtk-2.4.11.patch"
                }
            ]
        },
        {
            "name": "python",
            "modules": [
                {
                    "name": "py2cairo",
                    "rm-configure": true,
                    "sources": [
                        {
                            "type": "archive",
                            "url": "http://cairographics.org/releases/py2cairo-1.10.0.tar.bz2",
                            "sha256": "d30439f06c2ec1a39e27464c6c828b6eface3b22ee17b2de05dc409e429a7431"
                        },
                        {
                            "type": "script",
                            "commands": [
                                "libtoolize --force",
                                "aclocal",
                                "autoheader",
                                "automake --force-missing --add-missing --foreign",
                                "autoconf"
                            ],
                            "dest-filename": "autogen.sh"
                        }
                    ]
                },
                {
                    "name": "pygobject",
                    "config-opts": [ "--disable-introspection" ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "http://ftp.gnome.org/pub/GNOME/sources/pygobject/2.28/pygobject-2.28.7.tar.xz",
                            "sha256": "bb9d25a3442ca7511385a7c01b057492095c263784ef31231ffe589d83a96a5a"
                        },
                        {
                            "type": "shell",
                            "commands": [ "cp -p /usr/share/automake-*/config.{sub,guess} ." ]
                        }
                    ]
                },
                {
                    "name": "pygtk",
                    "sources": [
                        {
                            "type": "archive",
                            "url": "http://ftp.gnome.org/pub/GNOME/sources/pygtk/2.24/pygtk-2.24.0.tar.gz",
                            "sha256": "6e3e54fa6e65a69ac60bd58cb2e60a57f3346ac52efe995f3d10b6c38c972fd8"
                        },
                        {
                            "type": "shell",
                            "commands": [ "cp -p /usr/share/automake-*/config.{sub,guess} ." ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "gexiv2",
            "modules": [
                {
                    "name": "exiv2",
                    "buildsystem": "cmake-ninja",
                    "builddir": true,
                    "cleanup": [ "/bin", "/share" ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "http://www.exiv2.org/builds/exiv2-0.27.0a-Source.tar.gz",
                            "sha256": "a4adfa7aaf295b0383adead476f8e0493b9d6c6c7570d5884d2ebf8a2871902f"
                        }
                    ]
                }
            ],
            "buildsystem": "meson",
            "config-opts": [ "-D=introspection=false" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/gexiv2/0.12/gexiv2-0.12.0.tar.xz",
                    "sha256": "58f539b0386f36300b76f3afea3a508de4914b27e78f58ee4d142486a42f926a"
                }
            ]
        },
        {
            "name": "openexr",
            "modules": [
                {
                    "name": "ilmbase",
                    "config-opts": [ "--disable-static" ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "http://download.savannah.nongnu.org/releases/openexr/ilmbase-2.2.1.tar.gz",
                            "sha256": "cac206e63be68136ef556c2b555df659f45098c159ce24804e9d5e9e0286609e"
                        },
                        {
                            "type": "shell",
                            "commands": [ "cp -p /usr/share/automake-*/config.{sub,guess} ." ]
                        }
                    ]
                }
            ],
            "config-opts": [ "--disable-static", "--disable-ilmbasetest" ],
            "cleanup": [ "/bin", "/share/doc" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://download.savannah.nongnu.org/releases/openexr/openexr-2.2.1.tar.gz",
                    "sha256": "8f9a5af6131583404261931d9a5c83de0a425cb4b8b25ddab2b169fbf113aecd"
                },
                {
                    "type": "shell",
                    "commands": [ "cp -p /usr/share/automake-*/config.{sub,guess} ." ]
                }
            ]
        },
        {
            "name": "libraw",
            "config-opts": [ "--disable-static" ],
            "cleanup": [ "/bin", "/share/doc" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://www.libraw.org/data/LibRaw-0.19.0.tar.gz",
                    "sha256": "e83f51e83b19f9ba6b8bd144475fc12edf2d7b3b930d8d280bdebd8a8f3ed259"
                }
            ]
        },
        {
            /* This is a GIMP direct dependency, but also for poppler. So make sure
             * we build this before poppler.
             */
            "name": "openjpeg",
            "buildsystem": "cmake-ninja",
            "builddir": true,
            "cleanup": [ "/bin", "/lib/openjpeg-2.3" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/uclouvain/openjpeg/archive/v2.3.1.tar.gz",
                    "sha256": "63f5a4713ecafc86de51bfad89cc07bb788e9bba24ebbf0c4ca637621aadb6a9"
                }
            ]
        },
        {
            "name": "poppler",
            "modules": [
                {
                    "name": "popplerdata",
                    "buildsystem": "cmake-ninja",
                    "builddir": true,
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://poppler.freedesktop.org/poppler-data-0.4.9.tar.gz",
                            "sha256": "1f9c7e7de9ecd0db6ab287349e31bf815ca108a5a175cf906a90163bdbe32012"
                        }
                    ]
                }
            ],
            "config-opts": [ "-DENABLE_GOBJECT_INTROSPECTION=OFF", "-DOpenJPEG_DIR=/usr/lib64/openjpeg-2.3" ],
            "cleanup": [ "/bin", "/share" ],
            "buildsystem": "cmake-ninja",
            "builddir": true,
            "sources": [
                {
                    "type": "archive",
                    "url": "https://poppler.freedesktop.org/poppler-0.75.0.tar.xz",
                    "sha256": "3bbaedb0fa2797cac933a0659d144303e4d09eec6892c65600da987d8707199a"
                }
            ]
        },
        {
            "name": "aalib",
            "config-opts": [ "--disable-static" ],
            "cleanup": [ "/bin", "/info", "/man" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://src.fedoraproject.org/repo/pkgs/rpms/aalib/aalib-1.4rc5.tar.gz/9801095c42bba12edebd1902bcf0a990/aalib-1.4rc5.tar.gz",
                    "sha256": "fbddda9230cf6ee2a4f5706b4b11e2190ae45f5eda1f0409dc4f99b35e0a70ee"
                },
                {
                    "type": "shell",
                    "commands": [ "cp -p /usr/share/automake-*/config.{sub,guess} ." ]
                }
            ]
        },
        {
            "name": "libmng",
            "config-opts": [ "--disable-static" ],
            "cleanup": [ "/share" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://src.fedoraproject.org/repo/pkgs/rpms/libmng/libmng-2.0.3.tar.gz/7e9a12ba2a99dff7e736902ea07383d4/libmng-2.0.3.tar.gz",
                    "sha256": "cf112a1fb02f5b1c0fce5cab11ea8243852c139e669c44014125874b14b7dfaa"
                }
            ]
        },
        {
            "name": "libwmf",
            "config-opts": [ "--disable-static", "--disable-dependency-tracking" ],
            "cleanup": [ "/share/doc", "/bin" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://src.fedoraproject.org/repo/pkgs/rpms/libwmf/v0.2.12.tar.gz/sha512/9280851e560becc91546906b911e0c59a1abd690e10680f6d94a335d66aeaec5eb12ccf2214ee7af2a15729a7b5f8b906022822399b4e2bc12c75a2d75748cab/v0.2.12.tar.gz",
                    "sha512": "9280851e560becc91546906b911e0c59a1abd690e10680f6d94a335d66aeaec5eb12ccf2214ee7af2a15729a7b5f8b906022822399b4e2bc12c75a2d75748cab"
                },
                {
                    "type": "shell",
                    "commands": [ "cp -p /usr/share/automake-*/config.{sub,guess} ." ]
                }
            ]
        },
        {
            "name": "ghostscript",
            "config-opts": [ "--disable-cups" ],
            "make-args": [ "so" ],
            "make-install-args": [ "soinstall" ],
            "cleanup": [ "/bin", "/share/man", "/share/ghostscript/9.26/doc/", "/share/ghostscript/9.26/examples" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs926/ghostscript-9.26.tar.gz",
                    "sha512": "670159c23618ffafa85c671642bf182a107a82c053a1fd8c3f45f73f203524077be1b212d2ddbabae7892c7713922877e03b020f78bd2aab1ae582c4fc7d820a"
                },
                {
                    "type": "shell",
                    "commands": [
                                  "cp -p /usr/share/automake-*/config.{sub,guess} freetype/builds/unix/",
                                  "cp -p /usr/share/automake-*/config.{sub,guess} ijs/",
                                  "cp -p /usr/share/automake-*/config.{sub,guess} jpeg/",
                                  "cp -p /usr/share/automake-*/config.{sub,guess} libpng/",
                                  "cp -p /usr/share/automake-*/config.{sub,guess} lcms2mt/",
                                  "cp -p /usr/share/automake-*/config.{sub,guess} tiff/config/",
                                  "rm -rf libpng/pngread.c"
                                ]
                }
            ]
        },
        {
            "name": "json-c",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/json-c/json-c/archive/json-c-0.13.1-20180305.tar.gz",
                    "sha256": "5d867baeb7f540abe8f3265ac18ed7a24f91fe3c5f4fd99ac3caba0708511b90"
                }
            ]
        },
        {
            "name": "libmypaint",
            "config-opts": [ "--disable-gegl", "--disable-introspection" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/mypaint/libmypaint/releases/download/v1.3.0/libmypaint-1.3.0.tar.xz",
                    "sha256": "6a07d9d57fea60f68d218a953ce91b168975a003db24de6ac01ad69dcc94a671"
                }
            ]
        },
        {
            "name": "mypaint-brushes",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/mypaint/mypaint-brushes.git",
                    "branch": "v1.3.x",
                    "commit": "2c567a19d47c2c23a5a512c9193f4dd61168c69e"
                }
            ]
        },
        {
            "name": "gfortran",
            "buildsystem": "simple",
            "build-commands": [
                "cp -a /usr/lib/sdk/gfortran-62/bin /app",
                "cp -a /usr/lib/sdk/gfortran-62/lib /app",
                "cp -a /usr/lib/sdk/gfortran-62/libexec /app"
            ]
        },
        {
            "name": "SuiteSparse",
            "buildsystem": "simple",
            "build-commands": [
                "cd SuiteSparse_config/ && make library && make install INSTALL=/app",
                "cd AMD/ && make library && make install INSTALL=/app",
                "cd COLAMD/ && make library && make install INSTALL=/app",
                "cd CCOLAMD/ && make library && make install INSTALL=/app",
                "cd CAMD/ && make library && make install INSTALL=/app",
                "cd metis-5.1.0/ && make config prefix=/app && make install",
                "cd CHOLMOD/ && CFLAGS=\"-fPIC\" LDFLAGS=\"-fPIC -lgfortran -L/app/lib\" make library && CFLAGS=\"-fPIC\" LDFLAGS=\"-fPIC -lgfortran -L/app/lib\" make install INSTALL=/app",
                "cd UMFPACK/ && make library && make install INSTALL=/app"
            ],
            "cleanup": [ "/share/doc" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://faculty.cse.tamu.edu/davis/SuiteSparse/SuiteSparse-5.2.0.tar.gz",
                    "sha256": "3c46c035ea8217649958a0f73360e825b0c9dcca4e32a9349d2c7678c0d48813"
                }
            ],
            "modules": [
                {
                    "name": "lapack",
                    "buildsystem": "cmake",
                    "builddir": true,
                    "build-options" : {
                        "arch" : {
                            "arm" : {
                                "cflags": "-fPIC",
                                "cxxflags": "-fPIC"
                            },
                            "x86_64" : {
                                "cflags": "-fPIC",
                                "cxxflags": "-fPIC"
                            }
                        }
                    },
                    "sources": [
                        {
                            "type": "archive",
                            "url": "http://www.netlib.org/lapack/lapack-3.8.0.tar.gz",
                            "sha256": "deb22cc4a6120bff72621155a9917f485f96ef8319ac074a7afbc68aab88bcf6"
                        }
                    ]
                },
                {
                    "name": "openblas",
                    "cleanup": [ "/bin" ],
                    "buildsystem": "simple",
                    "build-commands": [
                        "make NO_LAPACKE=1 NO_LAPACK=1 NO_CBLAS=1 DYNAMIC_ARCH=1",
                        "make NO_LAPACKE=1 NO_LAPACK=1 NO_CBLAS=1 DYNAMIC_ARCH=1 install PREFIX=/app"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://github.com/xianyi/OpenBLAS/archive/v0.3.1.tar.gz",
                            "sha256": "1f5e956f35f3acdd3c74516e955d797a320c2e0135e31d838cbdb3ea94d0eb33"
                        }
                    ]
                }
            ]
        }
    ]
}
